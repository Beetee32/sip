<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SIP Planner â€“ The One That Actually Converts</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
  :root{--bg:#f8fafc;--card:#fff;--accent:#0d9488;--muted:#64748b;--success:#16a34a;--danger:#dc2626;--gold:#ca8a04}
  *{box-sizing:border-box}
  body{font-family:Inter,system-ui,Arial,sans-serif;background:var(--bg);margin:0;padding:20px 16px;color:#1e293b;line-height:1.6}
  .wrap{max-width:1100px;margin:0 auto}
  .header{display:flex;flex-wrap:wrap;gap:16px;justify-content:space-between;align-items:center;margin-bottom:20px}
  h1{font-size:24px;margin:0;font-weight:900}
  .sub{color:var(--muted);font-size:14px}
  .card{background:var(--card);border-radius:16px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,0.08)}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
  label{display:block;font-size:14px;font-weight:600;margin-bottom:6px}
  input[type=number],select,radio{width:100%;padding:12px;border-radius:10px;border:1px solid #cbd5e1;font-size:15px}
  .controls{display:flex;flex-wrap:wrap;gap:12px;margin-top:20px;align-items:center}
  .btn{padding:14px 24px;border-radius:12px;border:none;cursor:pointer;font-weight:700;font-size:16px;transition:all .2s}
  .btn.primary{background:var(--accent);color:#fff}
  .btn.big{background:#25D366;color:#fff;font-size:18px;padding:18px 32px;border-radius:16px;box-shadow:0 8px 25px rgba(37,211,102,0.3)}
  .panel{background:#f0fdfa;border-radius:14px;padding:20px;border:1px solid #ccfbf1;margin-top:20px}
  .kpi{font-size:32px;font-weight:900;color:var(--accent)}
  .big{font-size:40px;font-weight:900;color:var(--accent)}
  .muted{color:var(--muted);font-size:14px}
  .segmented{display:inline-flex;border-radius:12px;overflow:hidden;border:1px solid #cbd5e1}
  .segmented button{background:#fff;padding:10px 18px;cursor:pointer;font-weight:600}
  .segmented button.active{background:var(--accent);color:#fff}
  .topbar{background:#fff;border-radius:12px;padding:16px;margin:20px 0;box-shadow:0 4px 15px rgba(0,0,0,0.08);display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px}
  .whatsapp{position:fixed;right:16px;bottom:16px;z-index:999}
  .highlight{background:#fffbeb;border:1px solid #fde68a;padding:16px;border-radius:12px;margin:16px 0}
  .fd-box{background:#fef2f2;border:1px solid #fca5a5;padding:20px;border-radius:12px}
  .emergency{background:#ecfdf5;border:1px solid #86efac;padding:16px;border-radius:12px}
  .emergency.red{background:#fef2f2;border-color:#fca5a5}
  @media(min-width:768px){.grid{grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}}
</style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <div>
      <h1>SIP Planner</h1>
      <div class="sub">Watch â‚¹50,000 become â‚¹5+ Crore</div>
    </div>
    <div style="display:flex;gap:12px">
      <button id="downloadBtn" class="btn primary">Download Excel</button>
      <button id="resetBtn" class="btn" style="border:1px solid #94a3b8">Reset</button>
    </div>
  </div>

  <div class="card">
    <div style="display:flex;gap:12px;margin-bottom:20px">
      <button id="tabPlanner" class="btn" style="font-weight:700">Planner</button>
      <button id="tabGoal" class="btn">Goal Planner</button>
    </div>

    <!-- Planner -->
    <div id="panePlanner">
      <div style="margin-bottom:16px">
        <label>Who is investing?</label>
        <div style="display:flex;gap:20px">
          <label><input type="radio" name="person" value="single" checked> Single person</label>
          <label><input type="radio" name="person" value="couple"> Couple</label>
        </div>
      </div>

      <div class="grid">
        <div id="ageSingle"><label>Your Age</label><input id="age1" type="number" value="35"></div>
        <div id="ageHusband" style="display:none"><label>Husband Age</label><input id="ageH" type="number" value="38"></div>
        <div id="ageWife" style="display:none"><label>Wife Age</label><input id="ageW" type="number" value="35"></div>

        <div><label>Monthly Income (â‚¹)</label><input id="income" type="number" value="200000"></div>
        <div><label>Monthly Expenses (â‚¹)</label><input id="expense" type="number" value="100000"></div>
      </div>

      <hr style="margin:24px 0;border:none;border-top:1px solid #e2e8f0">

      <div style="background:#f0f9ff;padding:16px;border-radius:12px">
        <label>How do you want to set SIP amount?</label>
        <div style="display:flex;gap:20px;margin:12px 0">
          <label><input type="radio" name="sipMode" value="auto" checked> Auto (from surplus)</label>
          <label><input type="radio" name="sipMode" value="manual"> Manual amount</label>
        </div>
        <div id="manualSIP" style="display:none;margin-top:12px">
          <label>I want to invest â‚¹ <input id="manualAmount" type="number" value="50000" style="width:150px;display:inline-block"> per month</label>
        </div>
      </div>

      <div style="display:flex;flex-wrap:wrap;gap:20px;justify-content:space-between;align-items:end;margin-top:20px">
        <div>
          <div style="margin-bottom:8px;font-weight:700">Risk Profile</div>
          <div class="segmented">
            <button id="presetCons" class="seg-btn">Conservative</button>
            <button id="presetBal" class="seg-btn active">Balanced</button>
            <button id="presetAgg" class="seg-btn">Aggressive</button>
          </div>
        </div>
        <div style="min-width:320px">
          <label>Allocation (Large â€¢ Mid â€¢ Small %)</label>
          <div style="display:flex;gap:8px">
            <input id="lc" type="number" value="45"><input id="mc" type="number" value="30"><input id="sc" type="number" value="25">
          </div>
        </div>
      </div>

      <div class="controls">
        <div><label>Time Horizon</label>
          <select id="years">
            <option value="3">3 years</option><option value="6">6 years</option><option value="9">9 years</option>
            <option value="12">12 years</option><option value="15" selected>15 years</option><option value="18">18 years</option>
            <option value="21">21 years</option><option value="24">24 years</option><option value="27">27 years</option><option value="30">30 years</option>
          </select>
        </div>
        <div><label>Large cap %</label><input id="lc_r" type="number" value="9" step="0.5"></div>
        <div><label>Mid cap %</label><input id="mc_r" type="number" value="12" step="0.5"></div>
        <div><label>Small cap %</label><input id="sc_r" type="number" value="16" step="0.5"></div>
        <button id="calc" class="btn primary">Show My Future</button>
      </div>

      <!-- Results Start Here -->
      <div id="results" style="display:none">

        <!-- Top Summary -->
        <div class="topbar">
          <div><div class="muted">Total Income</div><div class="kpi" id="topIncome">â‚¹2 L</div></div>
          <div><div class="muted">Total Expense</div><div class="kpi" id="topExpense">â‚¹1 L</div></div>
          <div><div class="muted">Money in SIP</div><div class="kpi" id="topSIP">â‚¹1 L</div></div>
        </div>

        <!-- Money Story -->
        <div class="panel" style="text-align:center">
          <h2>Your Money Story</h2>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:32px;max-width:600px;margin:0 auto">
            <div><div class="muted">You invest</div><div class="kpi" id="totalInvested">â‚¹1.8 Cr</div></div>
            <div><div class="muted">Becomes</div><div class="big" id="finalCorpus">â‚¹5.6 Cr</div></div>
          </div>
          <div style="margin:24px 0;font-size:48px">â†’</div>
          <div class="highlight">
            <div class="muted">Wealth created</div>
            <div class="big" style="color:#16a34a" id="wealthCreated">â‚¹3.8 Cr</div>
            <div style="font-size:24px;margin-top:8px" id="multiplier">6.1Ã— your money ðŸš€</div>
          </div>
        </div>

        <!-- Add 5k Slider -->
        <div class="panel">
          <label>What if you add just â‚¹5,000 more per month?</label>
          <input type="range" id="extraSIP" min="0" max="20000" step="1000" value="0" style="width:100%">
          <div style="text-align:center;font-size:20px;margin-top:12px">
            Extra â‚¹<span id="extraAmount">0</span>k/month â†’ +<span id="extraCorpus">â‚¹0</span> in final corpus
          </div>
        </div>

        <!-- FD vs Equity -->
        <div class="fd-box">
          <strong>Fixed Deposit @7% after tax â†’ â‚¹2.1 Cr</strong><br>
          <strong>Equity @12% â†’ â‚¹5.6 Cr</strong><br>
          <span class="danger">By choosing FD, you lose â‚¹3.5 Cr â€” thatâ€™s a 3BHK in a good city.</span>
        </div>

        <!-- SWP -->
        <div class="panel">
          <h3>Passive Income (SWP)</h3>
          <div class="kpi">â‚¹<span id="swpMonthly">1.8 Lakh</span>/month for <span id="swpYears">35+ years</span> (4% safe withdrawal)</div>
        </div>

        <!-- Inflation Goals -->
        <div class="panel">
          <h3>Future Costs (6% inflation)</h3>
          <div class="grid">
            <div>Child Education (2040) â†’ â‚¹1.4 Cr</div>
            <div>Child Marriage (2045) â†’ â‚¹85 Lakh</div>
            <div>Retirement need (2055) â†’ â‚¹3.5 L/month</div>
          </div>
        </div>

        <!-- Emergency Fund -->
        <div id="emergencyBox" class="emergency">Checking emergency fund...</div>

        <!-- Talk on WhatsApp -->
        <div style="text-align:center;margin:32px 0">
          <a href="#" id="talkWA" class="btn big">Talk on WhatsApp â†’ Start My SIP</a>
        </div>

        <!-- Chart -->
        <div class="panel">
          <h3>Wealth Growth Over Time</h3>
          <canvas id="growthChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Goal Tab (hidden for now) -->
    <div id="paneGoal" style="display:none">Goal planner coming soon</div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const $ = id => document.getElementById(id);

  const fmt = n => {
    if (isNaN(n)) return "â‚¹0";
    const abs = Math.abs(n);
    if (abs >= 1e7) return "â‚¹" + (n/1e7).toFixed(1) + " Cr";
    if (abs >= 1e5) return "â‚¹" + (n/1e5).toFixed(1) + " L";
    return "â‚¹" + n.toLocaleString('en-IN');
  };

  const fvSIP = (m, r, y) => {
    if (!m) return 0;
    const i = r/100/12, n = y*12;
    return i === 0 ? m*n : m * ((Math.pow(1+i,n)-1)/i) * (1+i);
  };

  const presets = {conservative:{lc:50,mc:30,sc:20}, balanced:{lc:45,mc:30,sc:25}, aggressive:{lc:35,mc:35,sc:30}};

  let chart = null;

  const calculate = () => {
    const income = +$('income').value;
    const expense = +$('expense').value;
    const years = +$('years').value;
    const lc_r = +$('lc_r').value, mc_r = +$('mc_r').value, sc_r = +$('sc_r').value;
    const lc = +$('lc').value, mc = +$('mc').value, sc = +$('sc').value;
    const extra = +$('extraSIP').value;

    let sip = income - expense;
    if ($('sipMode_manual')?.checked) sip = +$('manualAmount').value;
    sip += extra;

    const avgRate = (lc*lc_r + mc*mc_r + sc*sc_r)/100;
    const totalInvested = sip * 12 * years;
    const corpus = fvSIP(sip, avgRate, years);
    const wealth = corpus - totalInvested;

    // Update UI
    $('topIncome').textContent = fmt(income);
    $('topExpense').textContent = fmt(expense);
    $('topSIP').textContent = fmt(sip);
    $('totalInvested').textContent = fmt(totalInvested);
    $('finalCorpus').textContent = fmt(corpus);
    $('wealthCreated').textContent = fmt(wealth);
    $('multiplier').textContent = (corpus/totalInvested).toFixed(1) + "Ã— your money ðŸš€";
    $('extraAmount').textContent = extra/1000;
    $('extraCorpus').textContent = fmt(fvSIP(extra, avgRate, years));
    $('swpMonthly').textContent = Math.round(corpus * 0.04 / 12 / 100000) + " Lakh";
    $('talkWA').href = `https://wa.me/917666123827?text=Hi! I can invest â‚¹${sip.toLocaleString('en-IN')}/month for ${years} years. Please help me start my SIP today.`;

    // Emergency fund
    const needed = expense * 9;
    $('emergencyBox').textContent = sip >= needed/12/2 ? "Emergency fund: Covered âœ“" : "Build emergency fund first (6â€“12 months expenses needed)";
    $('emergencyBox').className = sip >= needed/12/2 ? "emergency" : "emergency red";

    // Chart
    if (chart) chart.destroy();
    const labels = Array.from({length: years+1}, (_,i) => i===0 ? "Now" : `Year ${i}`);
    const data = labels.map((_,i) => i===0 ? 0 : fvSIP(sip, avgRate, i));
    chart = new Chart($('growthChart'), {
      type:'line', data:{labels, datasets:[{label:'Your Wealth', data, borderColor:'#0d9488', backgroundColor:'rgba(13,148,136,0.1)', fill:true, tension:0.4}]},
      options:{plugins:{tooltip:{callbacks:{label:c=>fmt(c.raw)}}}, scales:{y:{ticks:{callback:v=>v>=1e7?(v/1e7).toFixed(1)+' Cr':(v/1e5).toFixed(1)+' L'}}}}
    });

    $('results').style.display = 'block';
  };

  // Event Listeners
  $('calc').onclick = calculate;
  $('extraSIP').oninput = calculate;
  document.querySelectorAll('[name="sipMode"]').forEach(r => r.onchange = () => {
    $('manualSIP').style.display = r.value === 'manual' ? 'block' : 'none';
    calculate();
  });
  document.querySelectorAll('[name="person"]').forEach(r => r.onchange = () => {
    const couple = r.value === 'couple';
    $('ageSingle').style.display = couple ? 'none' : 'block';
    $('ageHusband').style.display = couple ? 'block' : 'none';
    $('ageWife').style.display = couple ? 'block' : 'none';
  });

  // Presets
  const applyPreset = name => {
    const p = presets[name];
    $('lc').value = p.lc; $('mc').value = p.mc; $('sc').value = p.sc;
    document.querySelectorAll('.seg-btn').forEach(b=>b.classList.remove('active'));
    $(`preset${name.charAt(0).toUpperCase()+name.slice(1)}`)?.classList.add('active');
    calculate();
  };
  $('presetCons').onclick = () => applyPreset('conservative');
  $('presetBal').onclick = () => applyPreset('balanced');
  $('presetAgg').onclick = () => applyPreset('aggressive');

  // Tabs
  $('tabPlanner').onclick = () => { $('panePlanner').style.display = ''; $('paneGoal').style.display = 'none'; };
  $('tabGoal').onclick = () => { $('panePlanner').style.display = 'none'; $('paneGoal').style.display = ''; };

  // Initial
  setTimeout(calculate, 500);
});
</script>
</body>
</html>
